<ion-header>
    <ion-navbar color="secondary">
        <button ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title>
            Reddit
        </ion-title>
    </ion-navbar>   
</ion-header>
 
<ion-content padding-top>
    <ion-refresher (ionRefresh)="refreshReddits($event)">
        <ion-refresher-content pullingText="Pull to refresh" refreshingText="Refreshing..."></ion-refresher-content>
    </ion-refresher>
    <ion-list class="selectable" *ngIf="objectService.isObject(items)" text-wrap>
        <ng-template ngFor let-item [ngForOf]="items">
            <ion-item *ngIf="item.data.selftext == ''">
                <p class="app-font-16">
                    {{item.data.title}}
                </p>
                <ng-template [ngIf]="objectService.isObject(item.data.preview) && item.data.thumbnail!='self'">
                    <img *ngIf="item.data.thumbnail != 'self' && !objectService.isObject(item.data.preview.images[0].variants.gif)" src="{{item.data.preview.images[0].source.url}}" imageViewer/>
                    <img *ngIf="item.data.thumbnail != 'self' && objectService.isObject(item.data.preview.images[0].variants.gif)" src="{{item.data.preview.images[0].variants.gif.source.url}}" imageViewer/>
                </ng-template>
                <ion-row>
                    <ion-col col-3>
                        <ion-icon name="thumbs-up">
                            {{item.data.score}}
                        </ion-icon>
                    </ion-col>
                    <ion-col col-8>
                        <ion-icon name="text">
                            {{item.data.num_comments}}
                        </ion-icon>
                    </ion-col>
                    <ion-col col-1>
                        <ion-icon name="open" (click)="iab.create('http://reddit.com'+item.data.permalink)"></ion-icon>
                    </ion-col>
                </ion-row>
            </ion-item>
            <button ion-item *ngIf="item.data.selftext != ''" (click)="viewItem(item.data)">
                <p class="app-font-16" padding-right>
                    {{item.data.title}}
                </p>
                <ng-template [ngIf]="objectService.isObject(item.data.preview) && item.data.thumbnail!='self'">
                    <img *ngIf="item.data.thumbnail != 'self' && !objectService.isObject(item.data.preview.images[0].variants.gif)" src="{{item.data.preview.images[0].source.url}}" imageViewer/>
                    <img *ngIf="item.data.thumbnail != 'self' && objectService.isObject(item.data.preview.images[0].variants.gif)" src="{{item.data.preview.images[0].variants.gif.source.url}}" imageViewer/>
                </ng-template>
                <ion-row>
                    <ion-col col-3>
                        <ion-icon name="thumbs-up">
                            {{item.data.score}}
                        </ion-icon>
                    </ion-col>
                    <ion-col col-9>
                         <ion-icon name="text">
                            {{item.data.num_comments}}
                        </ion-icon>
                    </ion-col>
                </ion-row>
            </button>
        </ng-template>
    </ion-list>
    <ion-item *ngIf="!objectService.isObject(items)" text-wrap>
        <p class="app-font-16" text-center>
            No items to show :(
            <br><br>
            Data is required to run this app, or Reddit servers are down
            <br><br>
            Pull to refresh
        </p>
    </ion-item>
    <ion-infinite-scroll *ngIf="objectService.isObject(items)" (ionInfinite)="moreReddits($event)">
        <ion-infinite-scroll-content loadingText="Loading Reddits..."></ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>
