<ion-header>
    <ion-navbar color="secondary">
        <button ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title>
            Reddit
        </ion-title>
    </ion-navbar>   
</ion-header>
 
<ion-content padding-top>
    <ion-refresher (ionRefresh)="refreshReddits($event)">
        <ion-refresher-content pullingText="Pull to refresh" refreshingText="Refreshing..."></ion-refresher-content>
    </ion-refresher>
    <ion-list class="selectable" *ngIf="objectService.isObject(items)" text-wrap>
        <ion-item *ngFor="let item of items" (click)="expandItem(item)" >
            <ion-row>
                <ion-col col-11>
                    <p class="app-font-16">
                        {{item.data.title}}
                    </p>
                </ion-col>
                <ion-col col-1>
                    <ion-icon *ngIf="item.data.selftext != ''" name="ios-arrow-down"></ion-icon>
                </ion-col>
            </ion-row>
            <ng-template [ngIf]="objectService.isObject(item.data.preview) && item.data.thumbnail!='self'">
                <img *ngIf="!objectService.isObject(item.data.preview.images[0].variants.gif)" src="{{item.data.preview.images[0].source.url}}" imageViewer/>
                <img-loader *ngIf="objectService.isObject(item.data.preview.images[0].variants.gif)" src="{{item.data.preview.images[0].variants.gif.source.url}}" useImg></img-loader>
            </ng-template>
            <expandable class="app-font-16" [expanded]="item.expanded">{{item.data.selftext}}</expandable>
            <ion-row>
                <ion-col col-3>
                    <ion-icon name="thumbs-up">
                        {{item.data.score}}
                    </ion-icon>
                </ion-col>
                <ion-col col-8>
                    <ion-icon name="text">
                        {{item.data.num_comments}}
                    </ion-icon>
                </ion-col>
                <ion-col col-1>
                    <ion-icon name="open" (click)="iab.create('http://reddit.com'+item.data.permalink, '_self', 'zoom=no')"></ion-icon>
                </ion-col>
            </ion-row>
        </ion-item>
    </ion-list>
    <ion-list *ngIf="!objectService.isObject(items)" text-wrap>
        <ion-item text-center>
            <div class="app-font-16">
                No items to show :(
                <br><br>
                Data is required to run this app, or Reddit servers are down
                <br><br>
                Pull to refresh
            </div>
        </ion-item>
    </ion-list>
    <ion-infinite-scroll (ionInfinite)="moreReddits($event)">
        <ion-infinite-scroll-content loadingText="Loading Reddits..."></ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>
